### **`mlops_core/` ã«ç½®ã â€œå…±é€šåŸºç›¤â€ ã®å…·ä½“æ©Ÿèƒ½ä¸€è¦§**

> ã–ã£ãã‚Šè¨€ãˆã° **ã€ŒKaggle æ¯ã«ä½•åº¦ã‚‚æ›¸ãç›´ã—ãŸããªã„â€œã‚¤ãƒ³ãƒ•ãƒ©ï¼†ä¸‹å›ã‚Šâ€ã€** ã‚’å…¨éƒ¨ã“ã“ã¸é›†ç´„ã—ã¾ã™ã€‚
> ã‚³ãƒ³ãƒšå›ºæœ‰ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯ `src/` ã«ã ã‘æ®‹ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

| ã‚«ãƒ†ã‚´ãƒª                 | ä»£è¡¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« / ã‚¯ãƒ©ã‚¹                                | ã©ã‚“ãªå‡¦ç†ã‚’è‚©ä»£ã‚ã‚Šã™ã‚‹ï¼Ÿ                                       | ä¾‹ API                                             |
| -------------------- | -------------------------------------------- | --------------------------------------------------- | ------------------------------------------------- |
| **â‘  ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å…±é€š**      | `logging.py`, `exceptions.py`, `paths.py`    | ãƒ­ã‚¬ãƒ¼åˆæœŸåŒ–ãƒ»å…±é€šä¾‹å¤–ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè§£æ±º                                | `from mlops_core.logging import get_logger`       |
| **â‘¡ è¨­å®šãƒ­ãƒ¼ãƒ‰**          | `config/loader.py`, `schema.py`              | YAML â†” `pydantic.BaseModel` ã§å‹å®‰å…¨ã«èª­ã¿è¾¼ã‚€               | `cfg = load_config("configs/train_config.yaml")`  |
| **â‘¢ ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤**         | `data/ingestion.py`, `database.py`, `dwh.py` | DuckDB / SQLite / cloud-DWH ã¸ã® I/Oã€S3 ã‚­ãƒ£ãƒƒã‚·ãƒ¥         | `ingest_csv("data/raw/train.csv", table="raw")`   |
| **â‘£ ç‰¹å¾´é‡ãƒ™ãƒ¼ã‚¹**         | `features/base.py`, `transformers.py`        | ã€Œfit â†’ transformã€ã®å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€pandas & polars å¯¾å¿œ     | <code>class TargetMeanEncoder(BaseFeature)</code> |
| **â‘¤ ML ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åŸºåº•**    | `ml/pipeline.py`, `model_wrapper.py`         | `fit/predict/save/load` ã²ãªå‹ï¼†ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³              | `pipe = TabularPipeline(cfg).fit(df)`             |
| **â‘¥ è©•ä¾¡ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹**       | `ml/evaluation.py`                           | LB æŒ‡æ¨™ + ãƒ­ãƒ¼ã‚«ãƒ«æŒ‡æ¨™ã®ä¸€å…ƒå®Ÿè£…                                 | `score_auc(y_true, y_pred)`                       |
| **â‘¦ ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°é€£æº**       | `tracking/mlflow_helper.py`                  | MLflow run ã®é–‹å§‹/çµ‚äº†ã€ã‚¿ã‚°ä»˜ã‘ã€ãƒ¢ãƒ‡ãƒ«ç™»éŒ²                        | `with mlflow_run(cfg): ...`                       |
| **â‘§ CLI / ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ** | `cli/train.py`, `cli/infer.py`               | `python -m mlops_core.train --cfg configs/...` ã§å³å®Ÿè¡Œ | hide / typer ã§å®Ÿè£…                                  |
| **â‘¨ ãƒ†ã‚¹ãƒˆç”¨ãƒ˜ãƒ«ãƒ‘**        | `testing/fixtures.py`                        | ãƒ€ãƒŸãƒ¼ DataFrameãƒ»TempDir ã®ä¾›çµ¦                           | `def dummy_df(code_length=100): ...`              |

---

#### ğŸŒŸ **ã“ã®ä¸­ã«ã€Œçµ¶å¯¾å…¥ã‚Œã¦ãŠãã¨å¬‰ã—ã„ã€æœ€å°ã‚»ãƒƒãƒˆ**

| å¿…é ˆåº¦ | ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«                             | ç†ç”±                                 |
| --- | --------------------------------- | ---------------------------------- |
| â˜…â˜…â˜… | `logging.py` + `config/loader.py` | å…¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã¾ãšå‘¼ã¶åŸºç›¤ã€‚                     |
| â˜…â˜…â˜… | `ml/pipeline.py`                  | å­¦ç¿’ãƒ»æ¨è«–ã® save/load äº’æ›æ€§ã‚’ä¿ã¤éµã€‚          |
| â˜…â˜…â˜† | `tracking/mlflow_helper.py`       | MLflow ã‚’æ¯å›ã‚³ãƒ”ãƒšã›ãšã«æ¸ˆã‚€ã€‚                |
| â˜…â˜…â˜† | `data/ingestion.py`               | DuckDB <-> pandas/polars ã®å®šå‹å‡¦ç†ã‚’çµ±ä¸€ã€‚ |
| â˜…â˜†â˜† | `features/base.py`                | å¤§ä¼šãŒé€²ã‚“ã§ç‰¹å¾´é‡ãŒå¢—ãˆã‚‹ã»ã©å¨åŠ›ç™ºæ®ã€‚               |

---

### **ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆ**

| è¦³ç‚¹         | ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`git submodule`)              | åˆ¥ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ (`pip install mlops_core`) |
| ---------- | -------------------------------------- | --------------------------------- |
| **æ”¹ä¿®åæ˜ **   | `git submodule update --remote` ã§å³å–ã‚Šè¾¼ã¿ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’ä¸Šã’ã¦ `pip install -U`      |
| **ãƒ­ãƒ¼ã‚«ãƒ«æ”¹å¤‰** | å„ã‚³ãƒ³ãƒšå´ã§ã‚‚ç›´æ¥ç·¨é›†ã§ãã‚‹ï¼ˆ*diff è¿½ãˆã¾ã™*ï¼‰            | PyPI é…å¸ƒãªã‚‰ fork å¿…è¦                 |
| **CI ç°¡ä¾¿ã•** | 1 repo ã®ã¿ãƒ“ãƒ«ãƒ‰å¯¾è±¡                         | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ç”¨ã®åˆ¥ CI ãŒè¦ã‚‹                 |

> **ã€Œã¾ãš submodule â†’ å¾Œã§ PyPIã€** ãŒæ¨å¥¨ãƒ«ãƒ¼ãƒˆã€‚
> æˆç†Ÿã—ã¦ã€ŒAPI ã‚‚ã†å¤‰ãˆãªã„ã€ã¨ç¢ºä¿¡ã§ããŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ PyPI åŒ–ã™ã‚‹ã¨ç®¡ç†ãŒæ¥½ã«ãªã‚Šã¾ã™ã€‚

---

### **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé››å½¢**

```
mlops_core/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ logging.py
â”œâ”€â”€ exceptions.py
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ loader.py
â”‚   â””â”€â”€ schema.py
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ paths.py
â”‚   â””â”€â”€ io.py
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ingestion.py
â”‚   â””â”€â”€ database.py
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ base.py
â”œâ”€â”€ ml/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ pipeline.py
â”‚   â”œâ”€â”€ model_wrapper.py
â”‚   â””â”€â”€ evaluation.py
â”œâ”€â”€ tracking/
â”‚   â””â”€â”€ mlflow_helper.py
â””â”€â”€ cli/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ train.py
    â””â”€â”€ infer.py
```

---

### **å°å…¥å¾Œã®ä½¿ç”¨ã‚¤ãƒ¡ãƒ¼ã‚¸ (ä¾‹)**

```python
# src/pipelines/train_pipeline.py
from mlops_core.config import load_config
from mlops_core.ml.pipeline import TabularPipeline
from mlops_core.tracking import mlflow_helper as mf

cfg = load_config("configs/train_config.yaml")

with mf.start_run(cfg):
    pipe = TabularPipeline(cfg)
    pipe.fit(cfg.data.train_path)
    mf.log_model(pipe.model, "best_model")
    pipe.save("models/best_model.pkl")
```

ã“ã‚Œã§ **å„ã‚³ãƒ³ãƒšãƒªãƒã‚¸ãƒˆãƒªå´ã¯ã€Œç‰¹å¾´é‡ã¨ãƒ¢ãƒ‡ãƒ«ãƒ­ã‚¸ãƒƒã‚¯ã€ã ã‘ã«é›†ä¸­**ã§ãã€
ãƒ­ã‚®ãƒ³ã‚°ãƒ»è¨­å®šãƒ»å®Ÿé¨“ç®¡ç†ã¯ **`mlops_core` ãŒãƒ¯ãƒ³ã‚¹ãƒˆãƒƒãƒ—ã§é¢å€’ã‚’è¦‹ã‚‹**æ§‹å›³ã«ãªã‚Šã¾ã™ã€‚
